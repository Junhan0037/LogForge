spring:
  application:
    name: logforge

  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://localhost:5432/logforge}
    username: ${SPRING_DATASOURCE_USERNAME:logforge}
    password: ${SPRING_DATASOURCE_PASSWORD:logforge}
    driver-class-name: org.postgresql.Driver

  jpa:
    # 배치 재실행을 고려해 스키마 관리는 마이그레이션 도구(Flyway/Liquibase)로 위임
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        format_sql: true
    show-sql: false
    open-in-view: false

  batch:
    jdbc:
      initialize-schema: always # 개발 환경에서 Batch 메타데이터 테이블 자동 생성. 운영에서는 사전 마이그레이션 후 none으로 조정
    job:
      enabled: false # 애플리케이션 기동 시 배치 잡 자동 실행 방지. 필요 시 환경 변수로 true로 설정

  sql:
    init:
      mode: never # # 스키마/데이터 초기화는 마이그레이션 도구로 수행
  flyway:
    # PostgreSQL 16.x 호환 버전을 사용하도록 명시적으로 구성(드라이버는 build.gradle에서 버전 고정)
    baseline-on-migrate: true

server:
  port: ${SERVER_PORT:8080}

management:
  endpoints:
    web:
      exposure:
        include: "health,info,metrics" # 배치/운영 모니터링을 위해 기본 헬스/정보/메트릭 엔드포인트를 노출

logging:
  level:
    # 배치/SQL 로깅 기본 레벨을 설정해 노이즈를 줄이고, 문제 발생 시 환경 변수로 조정
    org.springframework.batch: INFO
    org.springframework.jdbc.core: WARN

external:
  client:
    # 외부 로그 API 호출 정책 (코루틴 기반 WebClient)
    max-concurrent-requests: 5
    request-timeout-millis: 5000
    retry-attempts: 3
    retry-delay-millis: 200
    connect-timeout-millis: 3000
    response-timeout-millis: 5000
